From: Bruno Lorenz <b.lorenz@afterspring.org>
Date: Mon, 2 Jan 2017 16:18:59 +0100
Subject: Update config to be used as external module for nginx >= 1.9.11

Origin: https://github.com/senuphtyz/nginx-dav-ext-module/commit/e06c9edb52a81c462fd52c3df0926e29c12a7e54
---
 nginx-dav-ext-module/config | 17 ++++++++++++-----
 1 file changed, 12 insertions(+), 5 deletions(-)

diff --git a/nginx-dav-ext-module/config b/nginx-dav-ext-module/config
index 98b2b7a..00ac047 100644
--- a/nginx-dav-ext-module/config
+++ b/nginx-dav-ext-module/config
@@ -1,9 +1,16 @@
 ngx_addon_name="ngx_http_dav_ext_module"
 
-HTTP_MODULES="$HTTP_MODULES \
-		ngx_http_dav_ext_module"
 
-NGX_ADDON_SRCS="$NGX_ADDON_SRCS \
-		$ngx_addon_dir/ngx_http_dav_ext_module.c"
+if test -n "$ngx_module_link"; then
+    ngx_module_type=HTTP
+    ngx_module_name=ngx_http_dav_ext_module
+    ngx_module_srcs="$ngx_addon_dir/ngx_http_dav_ext_module.c"
+    ngx_module_libs="$ngx_module_libs -lexpat"
+
+    . auto/module
+else
+    HTTP_MODULES="$HTTP_MODULES "
+    NGX_ADDON_SRCS="$NGX_ADDON_SRCS $ngx_addon_dir/ngx_http_dav_ext_module.c"
+    CORE_LIBS="$CORE_LIBS -lexpat"
+fi
 
-CORE_LIBS="$CORE_LIBS -lexpat"
